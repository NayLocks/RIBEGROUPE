{% extends 'base.html.twig' %}

{% block title %}Nouvelle Fiche Article{% endblock %}

{% block page %}
	Nouvelle Fiche Article
{% endblock %}

{% block actionsPage %}
	<form method="POST">

    <div class="d-inline-block dropdown">
		<a type="button" class="btn mr-2 mb-2 btn-danger" href="{{ path("newFicheArticle") }}">
			<span class="btn-icon-wrapper pr-2 opacity-7">
				<i class="fa fa-eraser fa-w-20"></i>
			</span>
			Remettre à zéro la fiche
		</a>
	</div>

    <div class="d-inline-block dropdown">
		<button type="submit" class="btn mr-2 mb-2 btn-warning" name="BROUILLON">
			<span class="btn-icon-wrapper pr-2 opacity-7">
				<i class="fa fa-edit fa-w-20"></i>
			</span>
			Enregistrer en brouillon
		</button>
	</div>

	<div class="d-inline-block dropdown">
		<button type="submit" class="btn mr-2 mb-2 btn-success" name="VALID">
			<span class="btn-icon-wrapper pr-2 opacity-7">
				<i class="fa fa-check-square fa-w-20"></i>
			</span>
			Envoyer la fiche en validation
		</button>
	</div>
{% endblock %}

{% block body %}

<script>
function clickEvent() {
    let requestURL = 'https://geo.api.gouv.fr/communes?codePostal=' + document.getElementById("codePostal").value +'&fields=nom,code,codesPostaux,codeDepartement,codeRegion,population&format=json&geometry=centre';
    let request = new XMLHttpRequest();
    request.open('GET', requestURL);
    request.responseType = 'json';
    request.send();
    request.onload = function() {
    const ville = request.response;

    var select = document.getElementById("ville");
    var opts = select.getElementsByTagName('option');
    for (var i = 0; i < opts.length; i++) {
        select.removeChild(opts[i]);
    }

    var options = '';
    for (let i = 0; i < ville.length; i++) {
        console.log(ville[i].nom);
        options += '<option value="'+ville[i].nom+'" />';
        document.getElementById('ville').innerHTML = options;
    }
    }
}

function clickEventLiv() {
    let requestURL = 'https://geo.api.gouv.fr/communes?codePostal=' + document.getElementById("codePostalLiv").value +'&fields=nom,code,codesPostaux,codeDepartement,codeRegion,population&format=json&geometry=centre';
    let request = new XMLHttpRequest();
    request.open('GET', requestURL);
    request.responseType = 'json';
    request.send();
    request.onload = function() {
    const ville = request.response;

    var select = document.getElementById("villeLiv");
    var opts = select.getElementsByTagName('option');
    for (var i = 0; i < opts.length; i++) {
        select.removeChild(opts[i]);
    }

    var options = '';
    for (let i = 0; i < ville.length; i++) {
        console.log(ville[i].nom);
        options += '<option value="'+ville[i].nom+'" />';
        document.getElementById('villeLiv').innerHTML = options;
    }
    }
}
</script>

	<div class="tab-content">
		<div class="tab-pane tabs-animation fade show active" id="tab-content-0" role="tabpanel">
			<div class="main-card mb-3 card">
				<div class="card-body">
						<h5 class="card-title">Information Client</h5>

						<div class="form-row">
							<div class="col-md-5">
								<div class="position-relative form-group">
									<label for="nomAppel" class="">Nom d'Appel</label><input name="nomAppel" type="text" class="form-control" maxlength="250"></div>
							</div>
							<div class="col-md-2">
								
							</div>
							<div class="col-md-4">
								<div class="position-relative form-group">
									<label for="phoneStandard" class="">Téléphone Standard</label><input name="phoneStandard" type="text" class="form-control" maxlength="20"></div>
							</div>
							<div class="col-md-1">
								<div class="position-relative form-group">
									<label for="phoneStandardTel" class="">Type Télévente</label>
									<input name="phoneStandardTel" type="checkbox" class="form-control">
								</div>
							</div>
						</div>
						
						<div class="form-row">
							<div class="col-md-5">
								<div class="position-relative form-group">
									<label for="codeGestion" class="">Code Gestion</label><input name="codeGestion" type="text" class="form-control" maxlength="250"></div>
							</div>
							<div class="col-md-2">
								
							</div>
							<div class="col-md-4">
								<div class="position-relative form-group">
									<label for="phonePortable" class="">Téléphone Portable</label><input name="phonePortable" type="text" class="form-control" maxlength="20"></div>
							</div>
							<div class="col-md-1">
								<div class="position-relative form-group">
									<label for="phonePortableTel" class="">Type Télévente</label>
									<input name="phonePortableTel" type="checkbox" class="form-control">
								</div>
							</div>
						</div>

						<div class="form-row">
							<div class="col-md-5">
								<div class="position-relative form-group">
									<label for="raisonSociale" class="">Raison Sociale</label><input name="raisonSociale" type="text" class="form-control" maxlength="250"></div>
							</div>
							<div class="col-md-2">
								
							</div>
							<div class="col-md-5">
								<div class="position-relative form-group">
									<label for="faxStandard" class="">Téléphone Portable</label><input name="faxStandard" type="text" class="form-control" maxlength="20"></div>
							</div>
						</div>

						<div class="form-row">
							<div class="col-md-5">
								<div class="position-relative form-group">
									<label for="nomGrandCompte" class="">Nom Grand Compte</label><input name="nomGrandCompte" type="text" class="form-control" maxlength="250"></div>
							</div>
							<div class="col-md-2">
								
							</div>
							<div class="col-md-5">
								<div class="position-relative form-group">
									<label for="emailStandard" class="">Email Standard</label><input name="emailStandard" type="mail" class="form-control" maxlength="250"></div>
							</div>
						</div>
						
						<div class="form-row">
							<div class="col-md-5">
								<div class="position-relative form-group">
									<label for="adrLivraison" class="">Adresse Livraison</label><input name="adrLivraison" type="text" class="form-control" maxlength="250"></div>
							</div>
							<div class="col-md-2">
								
							</div>
							<div class="col-md-3">
								<div class="position-relative form-group">
									<label for="appelClient" class="">Client à Appeler</label>
								</div>
							</div>
							<div class="col-md-1">
								<div class="position-relative form-group">
  									<label for="oui">Oui</label>
									<input class="form-control" type="radio" id="oui" name="appelClient" value="oui" checked>
								</div>
							</div>
							<div class="col-md-1">
								<div class="position-relative form-group">
  									<label for="non">Non</label>
									<input class="form-control" type="radio" id="non" name="appelClient" value="non">
								</div>
							</div>
						</div>

						<div class="form-row">
							<div class="col-md-2">
								<div class="position-relative form-group">
									<label for="codePostal" class="">Code Postal</label><input id="codePostal" name="codePostal" type="text" class="form-control" maxlength="10" onkeyup="clickEvent()"></div>
							</div>
							<div class="col-md-3">
								<div class="position-relative form-group">
									<label for="ville" class="">Ville</label><input name="ville" list="ville" type="text" class="form-control" maxlength="250">
									<datalist id="ville"></datalist>
									</div>
							</div>
							<div class="col-md-2">
								
							</div>
							<div class="col-md-1">
								<div class="position-relative form-group">
									<label for="appelLundi" class="">Lundi</label>
									<input name="appelLundi" type="checkbox" class="form-control">
								</div>
							</div>
							<div class="col-md-4">
								<div class="position-relative form-group">
									<label for="horaireLundi" class="">Horaire Lundi</label><input name="horaireLundi" type="text" class="form-control" ></div>
							</div>
						</div>

						<div class="form-row">
							<div class="col-md-5">
								<div class="position-relative form-group">
									<label for="siret" class="">N° SIRET</label><input name="siret" type="text" class="form-control" ></div>
							</div>
							<div class="col-md-2">
								
							</div>
							<div class="col-md-1">
								<div class="position-relative form-group">
									<label for="appelMardi" class="">Mardi</label>
									<input name="appelMardi" type="checkbox" class="form-control">
								</div>
							</div>
							<div class="col-md-4">
								<div class="position-relative form-group">
									<label for="horaireMardi" class="">Horaire Mardi</label><input name="horaireMardi" type="text" class="form-control" ></div>
							</div>
						</div>

						<div class="form-row">
							<div class="col-md-5">
								<div class="position-relative form-group">
									<label for="tvaIntra" class="">N° TVA Intracommunautaire</label><input name="tvaIntra" type="text" class="form-control" ></div>
							</div>
							<div class="col-md-2">
								
							</div>
							<div class="col-md-1">
								<div class="position-relative form-group">
									<label for="appelMercredi" class="">Mercredi</label>
									<input name="appelMercredi" type="checkbox" class="form-control">
								</div>
							</div>
							<div class="col-md-4">
								<div class="position-relative form-group">
									<label for="horaireMercredi" class="">Horaire Mercredi</label><input name="horaireMercredi" type="text" class="form-control" ></div>
							</div>
						</div>

						<div class="form-row">
							<div class="col-md-3">
								<div class="position-relative form-group">
									<label for="typeClient" class="">Type Client <i style="font-weight : normal;">(Si client public = chorus, compléter impérativement les champs suivants: N° Siret, N° Engagement et Code Service)</i></label>
								</div>
							</div>
							<div class="col-md-1">
								<div class="position-relative form-group">
  									<label for="public">Public</label>
									<input class="form-control" type="radio" id="public" name="typeClient" value="public">
								</div>
							</div>
							<div class="col-md-1">
								<div class="position-relative form-group">
  									<label for="prive">Privé</label>
									<input class="form-control" type="radio" id="prive" name="typeClient" value="prive" checked>
								</div>
							</div>
							<div class="col-md-2">
								
							</div>
							<div class="col-md-1">
								<div class="position-relative form-group">
									<label for="appelJeudi" class="">Jeudi</label>
									<input name="appelJeudi" type="checkbox" class="form-control">
								</div>
							</div>
							<div class="col-md-4">
								<div class="position-relative form-group">
									<label for="horaireJeudi" class="">Horaire Jeudi</label><input name="horaireJeudi" type="text" class="form-control" ></div>
							</div>
						</div>

						<div class="form-row">
							<div class="col-md-6">
								<div class="position-relative form-group">
									<label for="engagement" class="">N° Engagement</label><input name="engagement" type="text" class="form-control" ></div>
							</div>
							<div class="col-md-1">
								<div class="position-relative form-group">
									<label for="appelVendredi" class="">Vendredi</label>
									<input name="appelVendredi" type="checkbox" class="form-control">
								</div>
							</div>
							<div class="col-md-5">
								<div class="position-relative form-group">
									<label for="horaireVendredi" class="">Horaire Vendredi</label><input name="horaireVendredi" type="text" class="form-control" ></div>
							</div>
						</div>

						<div class="form-row">
							<div class="col-md-6">
								<div class="position-relative form-group">
									<label for="codeService" class="">Code Service</label><input name="codeService" type="text" class="form-control"></div>
							</div>
							<div class="col-md-1">
								<div class="position-relative form-group">
									<label for="appelSamedi" class="">Samedi</label>
									<input name="appelSamedi" type="checkbox" class="form-control">
								</div>
							</div>
							<div class="col-md-5">
								<div class="position-relative form-group">
									<label for="horaireSamedi" class="">Horaire Samedi</label><input name="horaireSamedi" type="text" class="form-control" ></div>
							</div>
						</div>						

						<div class="form-row">
							<div class="col-md-6">
								<div class="position-relative form-group">
									<label for="adrLiv" class="">Adresse pour Envoi Factures (si différente d'Adresse Livraison)</label><input name="adrLiv" type="text" class="form-control"></div>
							</div>
							<div class="col-md-6">
								<div class="position-relative form-group">
									<label for="emailFacture" class="">Email Envoi Facture</label><input name="emailFacture" type="text" class="form-control" ></div>
							</div>
						</div>

						<div class="form-row">
							<div class="col-md-2">
								<div class="position-relative form-group">
									<label for="codePostalLiv" class="">Code Postal</label><input id="codePostalLiv" name="codePostalLiv" type="text" class="form-control" maxlength="10" onkeyup="clickEventLiv()"></div>
							</div>
							<div class="col-md-4">
								<div class="position-relative form-group">
									<label for="villeLiv" class="">Ville</label><input name="villeLiv" list="villeLiv" type="text" class="form-control" maxlength="250">
									<datalist id="villeLiv"></datalist>
									</div>
							</div>
							<div class="col-md-6">
								<div class="position-relative form-group">
									<label for="tarifClient" class="">Tarif Client</label><input name="tarifClient" type="text" class="form-control" ></div>
							</div>
						</div>
						
						<div class="form-row">
							<div class="col-md-6">
								<div class="position-relative form-group">
									<label for="stat1" class="">AFFTYPO CHAMPS STAT 1</label>
									<select class="form-control" name="stat1">
										<option value=""></option>
										{% for stat in stats1 %}
											<option value="{{ stat.Code_STAT1 }}">{{ stat.Libelle_STAT1 }}</option>
										{% endfor %}
									</select>
								</div>
							</div>
							<div class="col-md-4">
								<div class="position-relative form-group">
									<label for="typeClient" class="">Envoi Tarif Automatique</label>
								</div>
							</div>
							<div class="col-md-1">
								<div class="position-relative form-group">
  									<label for="oui">Oui</label>
									<input class="form-control" type="radio" id="oui" name="envoiTarifAuto" value="oui">
								</div>
							</div>
							<div class="col-md-1">
								<div class="position-relative form-group">
  									<label for="non">Non</label>
									<input class="form-control" type="radio" id="non" name="envoiTarifAuto" value="non" checked>
								</div>
							</div>
						</div>

						<div class="form-row">
							<div class="col-md-6">
								<div class="position-relative form-group">
									<label for="stat1" class="">AFFCAT 2 CHAMPS STAT 2</label>
									<select class="form-control" name="stat2">
										<option value=""></option>
										{% for stat in stats2 %}
											<option value="{{ stat.Code_STAT2 }}">{{ stat.Libelle_STAT2 }}</option>
										{% endfor %}
									</select>
								</div>
							</div>
							<div class="col-md-6">
								<div class="position-relative form-group">
									<label for="date1Livraison" class="">Date 1ère Livraison</label><input name="date1Livraison" type="date" class="form-control" ></div>
							</div>
						</div>
						
						<div class="form-row">
							<div class="col-md-6">
								<div class="position-relative form-group">
									<label for="stat1" class="">AFFCAT 3 CHAMPS STAT 3</label>
									<select class="form-control" name="stat3">
										<option value=""></option>
										{% for stat in stats3 %}
											<option value="{{ stat.Code_STAT3 }}">{{ stat.Libelle_STAT3 }}</option>
										{% endfor %}
									</select>
								</div>
							</div>
							<div class="col-md-4">
								<div class="position-relative form-group">
									<label for="typeClient" class="">PVC</label>
								</div>
							</div>
							<div class="col-md-1">
								<div class="position-relative form-group">
  									<label for="oui">Oui</label>
									<input class="form-control" type="radio" id="oui" name="pvc" value="oui">
								</div>
							</div>
							<div class="col-md-1">
								<div class="position-relative form-group">
  									<label for="non">Non</label>
									<input class="form-control" type="radio" id="non" name="pvc" value="non" checked>
								</div>
							</div>
						</div>

						<div class="form-row">
							<div class="col-md-6">
								<div class="position-relative form-group">
									<label for="stat1" class="">AFFCAT 1 CHAMPS STAT 4</label>
									<select class="form-control" name="stat4">
										<option value=""></option>
										{% for stat in stats4 %}
											<option value="{{ stat.Code_STAT4 }}">{{ stat.Libelle_STAT4 }}</option>
										{% endfor %}
									</select>
								</div>
							</div>
							<div class="col-md-6">
								<div class="position-relative form-group">
									<label for="coefPVC" class="">Coef PVC</label><input name="coefPVC" type="text" class="form-control" ></div>
							</div>
						</div>






					</form>
				</div>
			</div>
		</div>
	</div>
{% endblock %}

